---
title: "MATH 216 Homework 2"
author: "Katherine Hobbs"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    smooth_scroll: false
---

```{r, echo=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(readr) 
library(tidyr)
library(forcats)
library(knitr)
```


```{r, echo=FALSE, message=FALSE, cache=TRUE}
# Do not edit this code block. By setting cache=TRUE, we are saving the output 
# of this block to the cache. That way it only needs to run once.  This is
# especially useful for portions of code that take a long time to run.
profiles <- read_csv(file="profiles.csv")
```



## Admistrative:

Please indicate

* Who you collaborated with: Amanda Hotvedt
* Roughly how much time you spent on this HW so far: 4-5
* The URL of the RPubs published URL [here](https://www.nhl.com/).
* What gave you the most trouble: 

* Any comments you have:

There is still much that I can do with the data, so I will work on adding more visuals and summary statistics over the next week. I am having trouble figuring out how to arrange certain summary outputs in descending or ascending order, so I will work on that as well.


## Question 1:

Perform an Exploratory Data Analysis (EDA) on the `profiles` data set,
specifically on the relationship between gender and

* `income`
* `job`
* One more categorical variable of your choice

all keeping in mind in HW-3, you will be fitting a logistic regression to
predict a user's gender based on these variables.

```{r, echo=TRUE, message=TRUE, warning=TRUE, fig.width=8, fig.height=4.5}

profiles <- profiles %>%
  mutate(is_female = ifelse(sex=="f", 1, 0))

profiles_less <- profiles %>% 
  select(religion, is_female, income, job)

#Average Income in Full Data Set

profiles_less %>% 
  summarise("Avg Income" = mean(income))

#Average Income without "-1" values

profiles_less2 <- profiles_less %>% 
  filter(income != -1) 

profiles_less2 %>% 
  summarise("Adjusted Avg Income" = mean(income))

ggplot(data=profiles_less2, aes(x=income)) + geom_histogram(binwidth = 10000)

#Average Income by Gender

profiles_less2 %>% 
  group_by(is_female) %>% 
  summarise("Avg Income By Gender" = mean(income))

ggplot(data=profiles_less2, aes(x=income, y=..density..)) + 
  geom_histogram(binwidth = 20000) + 
  facet_wrap(~is_female) +
  xlab("Income") +
  ylab("Density") 
  
#Average Incombe by Job

profiles_less2 %>% 
  group_by(job) %>% 
  summarise("Avg Income By Job" = mean(income))  %>% 
  arrange(desc("Avg Income By Job"))

#arrange is not working here

#Gender Proportions by Job

profiles_less2 %>% 
  group_by(job) %>% 
  summarise("Gender Prop by Job" = mean(is_female)) %>% 
  arrange(desc("Gender Prop by Job"))


#Average Income by Job and Gender

profiles_less2 %>% 
  group_by(job, is_female) %>% 
  summarise("Avg Income By Job and Gender" = mean(income)) %>% 
  spread(key=is_female, value= "Avg Income By Job and Gender") 

#Group the Religions

profiles_religion <- profiles_less %>% 
  mutate(grouped_religion = fct_recode(religion,
                  "agnosticism" = "agnosticism",
                  "agnosticism" = "agnosticism and laughing about it",
                  "agnosticism" = "agnosticism and somewhat serious about it",
                  "agnosticism" = "agnosticism and very serious about it",
                  "agnosticism" = "agnosticism but not too serious about it",
                  "atheism" = "atheism",
                  "atheism" = "atheism and laughing about it",
                  "atheism" = "atheism and somewhat serious about it",
                  "atheism" = "atheism and very serious about it",
                  "atheism" = "atheism but not too serious about it",
                  "buddhism" = "buddhism",
                  "buddhism" = "buddhism and laughing about it",
                  "buddhism" = "buddhism and somewhat serious about it",
                  "buddhism" = "buddhism and very serious about it",
                  "buddhism" = "buddhism but not too serious about it",
                  "catholism" = "catholicism",
                  "catholism" = "catholicism and laughing about it",
                  "catholism" = "catholicism and somewhat serious about it",
                  "catholism" = "catholicism and very serious about it",
                  "catholism" = "catholicism but not too serious about it",
                  "christianity" = "christianity",
                  "christianity" = "christianity and laughing about it",
                  "christianity" ="christianity and somewhat serious about it",
                  "christianity" = "christianity and very serious about it",
                  "christianity" = "christianity but not too serious about it",
                  "hinduism" = "hinduism",
                  "hinduism" = "hinduism and laughing about it",
                  "hinduism" = "hinduism and somewhat serious about it",
                  "hinduism" = "hinduism and very serious about it",
                  "hinduism" = "hinduism but not too serious about it",
                  "islam" = "islam",
                  "islam" = "islam and laughing about it",
                  "islam" = "islam and somewhat serious about it",
                  "islam" = "islam and very serious about it",
                  "islam" = "islam but not too serious about it",
                  "judaism" = "judaism",
                  "judaism" = "judaism and laughing about it",
                  "judaism" = "judaism and somewhat serious about it",
                  "judaism" = "judaism and very serious about it",
                  "judaism" = "judaism but not too serious about it",
                  "other" = "other",
                  "other" = "other and laughing about it",
                  "other" = "other and somewhat serious about it",
                  "other" = "other and very serious about it",
                  "other" = "other but not too serious about it"))

#Proportion Female By Religion

profiles_religion %>% 
  group_by(grouped_religion) %>% 
  summarise("Gender Prop by Religion" = mean(is_female)) %>% 
  kable() 

profiles_religion <- profiles_religion%>% 
  group_by(grouped_religion) %>% 
  mutate("Gender Prop by Religion" = mean(is_female))

barplot(profiles_religion, aes(x=grouped_religion, y="Prop Gender By Religion")) 

#not sure why the barplot is not working

```


## Question 2:

In the file `HW-2_Shiny_App.Rmd`, build the Shiny App discussed in Lec09 on
Monday 10/3: Using the `movies` data set in the `ggplot2movies` data set, make a
Shiny app that

* Plots budget on the x-axis and rating on the y-axis
* Instead of having a radio button to select the genre of movie (`Action`,
`Animation`, `Comedy`, etc), have a radio button that allows you to toggle
between comedies and non-comedies. This app should be simpler.

